---
import { site } from "../data/site";
import { presentaciones } from "../data/presentaciones";
import logoM from "../assets/img/logo-m.jpg"; // o .png

type ImgLike = string | { src: string };

const bottleImages = import.meta.glob(
  "/src/assets/img/botellas/*.{jpg,jpeg,png,webp}",
  { eager: true, import: "default" }
) as Record<string, ImgLike>;

const toSrc = (img: ImgLike | undefined) => (typeof img === "string" ? img : img?.src);

const getBottleSrc = (fileName: string | null) => {
  if (!fileName) return logoM.src;
  const key = `/src/assets/img/botellas/${fileName}`;
  return toSrc(bottleImages[key]) ?? logoM.src;
};

const wa = (size: string) =>
  `https://wa.me/${site.phoneWa}?text=${encodeURIComponent(
    `Hola, quiero consultar por el Aceite de soja Muccino de ${size}. ¿Precio y disponibilidad?`
  )}`;
---

<div class="max-w-screen-xl mx-auto p-5 sm:p-10 md:p-16">
  <!-- Header tipo "blog" adaptado a Muccino -->
  <div class="border-b mb-5 flex justify-between text-sm">
    <div
      class="text-amber-400 flex items-center pb-2 pr-2 border-b-2 border-amber-400 uppercase"
    >
      <img src={logoM.src} alt="Muccino" class="h-6 w-6 mr-3 rounded" />
      <a href="#presentaciones" class="font-semibold inline-block">
        Presentaciones
      </a>
    </div>

    <a href="/#contacto" class="text-zinc-300 hover:text-white">Contacto</a>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-10">
    {presentaciones.map((p) => (
      <div class="rounded-2xl overflow-hidden border border-zinc-800 bg-zinc-900/40 shadow-lg flex flex-col">
        <!-- Imagen (clickeable a la página del producto) -->
        <div class="relative">
          <a href={`/productos/${p.slug}`} class="block">
            <img
              class="w-full h-44 object-contain bg-zinc-950/40"
              src={getBottleSrc(p.image ?? null)}
              alt={`Aceite de soja Muccino ${p.size}`}
              loading="lazy"
            />
            <div
              class="hover:bg-transparent transition duration-300 absolute inset-0 bg-zinc-950/10 hover:bg-zinc-950/0"
            ></div>
          </a>

          <!-- Badge arriba a la derecha (tamaño) -->
          <a href={`/productos/${p.slug}`}>
            <div
              class="text-xs absolute top-0 right-0 bg-amber-500/90 px-4 py-2 text-zinc-950 mt-3 mr-3 rounded-xl
                     hover:bg-zinc-100 transition duration-300 ease-in-out"
            >
              {p.size}
            </div>
          </a>
        </div>

        <!-- Contenido -->
        <div class="px-6 py-5 mb-auto">
          <a
            href={`/productos/${p.slug}`}
            class="font-semibold text-lg inline-block hover:text-amber-400 transition duration-300 ease-in-out mb-2"
          >
            Aceite de soja Muccino · {p.size}
          </a>

          <p class="text-zinc-400 text-sm">
            {p.description ?? `Presentación ideal para ${p.use.toLowerCase()}.`}
          </p>

          <!-- Mini highlight -->
          <div class="mt-4 text-xs text-zinc-400">
            <span class="tracking-widest">USO</span>:{" "}
            <span class="text-zinc-200 font-semibold">{p.use}</span>
            <span class="mx-2 text-zinc-600">•</span>
            <span class="text-zinc-300">{p.highlight}</span>
          </div>
        </div>

        <!-- Footer estilo blog: acciones -->
        <div class="px-6 py-4 flex flex-row items-center justify-between bg-zinc-950/40 border-t border-zinc-800">
          <a
            href={`/productos/${p.slug}`}
            class="py-1 text-xs font-semibold text-zinc-200 hover:text-white flex flex-row items-center"
          >
            <span class="mr-2">Ver detalle</span>
            <span class="text-zinc-500">→</span>
          </a>

          <a
            href={wa(p.size)}
            target="_blank"
            rel="noopener"
            class="py-1 text-xs font-semibold text-emerald-400 hover:text-emerald-300 flex flex-row items-center"
          >
            Consultar
          </a>
        </div>
      </div>
    ))}
  </div>
</div>
